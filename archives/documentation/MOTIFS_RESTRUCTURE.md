# NBDFinder Motifs Package Restructure

## Overview
The original `motifs.py` file has been restructured into a modular package following the 10-class classification system as requested.

## Package Structure

```
motifs/
├── __init__.py              # Main package interface
├── base_motif.py           # Common utilities and base functions
├── curved_dna.py           # Class 1: Curved DNA (Global Array, Local Tract)
├── slipped_dna.py          # Class 2: Slipped DNA (Direct Repeat, STR)
├── cruciform_dna.py        # Class 3: Cruciform DNA (Inverted Repeat/HairPin)
├── r_loop.py               # Class 4: R-loop
├── triplex.py              # Class 5: Triplex (Triplex, Sticky DNA)
├── g_quadruplex.py         # Class 6: G-Quadruplex Family (Multiple variants)
├── i_motif.py              # Class 7: i-motif Family (Canonical, Relaxed, AC-motif)
├── z_dna.py                # Class 8: Z-DNA (Z-DNA, eGZ)
├── hybrid.py               # Class 9: Hybrid (Dynamic overlaps)
├── cluster.py              # Class 10: Non-B DNA Cluster Regions (Dynamic hotspots)
└── visualization.py        # Advanced visualization suite
```

## New Output Format

Each motif now includes all required fields:
- S.No
- Sequence_Name  
- Chromosome/Contig
- Class
- Subclass
- Motif_ID
- Start
- End
- Length
- Normalized_Score
- Actual_Score
- Scoring_Method
- GC_Content
- Sequence
- Overlap_Classes

## Motif Classification

### Class 1: Curved DNA
- **1.1** Global Array (Global_Array)
- **1.2** Local Tract (Local_Tract)

### Class 2: Slipped DNA  
- **2.1** Direct Repeat (Direct_Repeat)
- **2.2** STR (STR)

### Class 3: Cruciform DNA
- **3.1** Inverted Repeat/HairPin (Inverted_Repeat)

### Class 4: R-loop
- **4.1** R-loop (RLFS_m1, RLFS_m2)

### Class 5: Triplex
- **5.1** Triplex (Triplex)
- **5.2** Sticky DNA (Sticky_DNA)

### Class 6: G-Quadruplex Family
- Multimeric G4 (Multimeric_G4)
- Canonical G4 (Canonical_G4)  
- Relaxed G4 (Relaxed_G4)
- Bulged G4 (Bulged_G4)
- Bipartite G4 (Bipartite_G4)
- Imperfect G4 (Imperfect_G4)
- G-Triplex intermediate (G-Triplex_intermediate)

### Class 7: i-motif Family
- **7.1** Canonical i-motif (Canonical_iMotif)
- **7.2** Relaxed i-motif (Relaxed_iMotif)  
- **7.3** AC-motif (AC-motif)

### Class 8: Z-DNA
- **8.1** Z-DNA (Z-DNA)
- **8.3** eGZ (Extruded-G) DNA (eGZ)

### Class 9: Hybrid
- Dynamic: generated by overlaps between any two classes

### Class 10: Non-B DNA Cluster Regions  
- Dynamic: any combination of ≥3 motif classes, each occurring 3+ times in 100 nt

## Usage

```python
import motifs

# Find all motifs in a sequence
seq = "ATCGATCG..."
results = motifs.all_motifs(seq, sequence_name="MySeq")

# Find specific motif types
curved_results = motifs.find_curved_DNA(seq, sequence_name="MySeq")
g4_results = motifs.find_g_quadruplex(seq, sequence_name="MySeq")

# Get standardized output format
formatted_results = motifs.format_motif_rows(results)

# Generate statistics
stats = motifs.get_basic_stats(seq, results)

# Create visualizations
from motifs.visualization import create_all_visualizations
create_all_visualizations(results_df)
```

## Key Features

1. **Modular Design**: Each motif class is in its own module for maintainability
2. **Standardized Output**: All motifs follow the same output format schema
3. **Backward Compatibility**: Main functions work exactly as before
4. **Enhanced Visualization**: Advanced plotting capabilities included
5. **Comprehensive Testing**: Full test suite validates functionality

## Changes from Original

- Split monolithic `motifs.py` into 10 class-specific modules
- Standardized output format with all required fields
- Added comprehensive visualization module
- Improved code organization and maintainability
- Enhanced documentation and testing

All original functionality has been preserved while adding the requested modular structure and standardized output format.